Import('env')

includes = [
    '#core/include',
    '#core/include/cmsis'
]
env.Append(CPPPATH=includes)

mcu     = env.SConscript('mcu/SConscript',      exports=['env'])
error   = env.SConscript('error/SConscript',    exports=['env'])

library = None
if 'Library' in env['BUILDERS']:
    library = env.Library(
        target = 'core',
        source = mcu['objects'] + error['objects']
    )

cmocks = list()
if 'CMock' in env['BUILDERS']:
    for h in ['include/nrf_error.h', 'include/nrf_assert.h', 'include/nrf_fault.h']:
        cmocks.append(env.CMock(h))

result = {
    'cmocks'    : cmocks,
    'library'   : library,
}
Return('result')